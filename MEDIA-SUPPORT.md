# üì∏ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ –≤ Chatroulette Backend

## ‚úÖ **–ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

### **üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤:**
- **–§–æ—Ç–æ:** JPEG, PNG, GIF, WebP (–¥–æ 10MB)
- **–í–∏–¥–µ–æ:** MP4, WebM, QuickTime (–¥–æ 100MB)
- **–ê—É–¥–∏–æ:** MP3, WAV, OGG, M4A (–¥–æ 25MB)
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤, –∑–∞—â–∏—Ç–∞ –æ—Ç path traversal
- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:** –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–∞—Ö –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### **üí¨ –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:**
- **text** - —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **image** - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- **video** - –≤–∏–¥–µ–æ
- **voice** - –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **sticker** - —Å—Ç–∏–∫–µ—Ä—ã
- **gif** - GIF –∞–Ω–∏–º–∞—Ü–∏–∏

## üöÄ **API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ–¥–∏–∞:**

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:**
```bash
POST /api/v1/upload
Content-Type: multipart/form-data

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
file: [—Ñ–∞–π–ª] - —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏

# –û—Ç–≤–µ—Ç:
{
  "file_id": "user_id_uuid.jpg",
  "file_url": "/uploads/user_id/filename.jpg",
  "media_type": "image",
  "size": 1024000,
  "created_at": "2025-10-03T10:00:00Z",
  "info": {
    "content_type": "image/jpeg",
    "is_image": true
  }
}
```

### **2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:**
```bash
GET /uploads/{user_id}/{file_name}

# –ü—Ä–∏–º–µ—Ä:
GET /uploads/123e4567-e89b-12d3-a456-426614174000/photo.jpg
```

### **3. –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:**
```bash
DELETE /api/v1/uploads/{file_name}
Authorization: Bearer {token}

# –û—Ç–≤–µ—Ç:
{
  "message": "File deleted successfully"
}
```

### **4. –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```bash
POST /api/v1/chats/{chat_id}/messages
Authorization: Bearer {token}
Content-Type: application/json

{
  "type": "image",
  "content": "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è",
  "media_url": "/uploads/user_id/filename.jpg"
}
```

## üìã **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**

### **üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:**
- **JPEG** (.jpg, .jpeg) - –¥–æ 10MB
- **PNG** (.png) - –¥–æ 10MB
- **GIF** (.gif) - –¥–æ 10MB
- **WebP** (.webp) - –¥–æ 10MB

### **üé• –í–∏–¥–µ–æ:**
- **MP4** (.mp4) - –¥–æ 100MB
- **WebM** (.webm) - –¥–æ 100MB
- **QuickTime** (.mov) - –¥–æ 100MB

### **üéµ –ê—É–¥–∏–æ:**
- **MP3** (.mp3) - –¥–æ 25MB
- **WAV** (.wav) - –¥–æ 25MB
- **OGG** (.ogg) - –¥–æ 25MB
- **M4A** (.m4a) - –¥–æ 25MB

## üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**

### **–ü—Ä–æ–≤–µ—Ä–∫–∏:**
- ‚úÖ **–¢–∏–ø —Ñ–∞–π–ª–∞** - —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ MIME —Ç–∏–ø—ã
- ‚úÖ **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø—É –º–µ–¥–∏–∞
- ‚úÖ **Path traversal** - –∑–∞—â–∏—Ç–∞ –æ—Ç `../` –∞—Ç–∞–∫
- ‚úÖ **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞** - UUID –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- ‚úÖ **–ò–∑–æ–ª—è—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** - —Ñ–∞–π–ª—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–∞–ø–∫–∞—Ö

### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** –º–∞–∫—Å–∏–º—É–º 10MB
- **–í–∏–¥–µ–æ:** –º–∞–∫—Å–∏–º—É–º 100MB
- **–ê—É–¥–∏–æ:** –º–∞–∫—Å–∏–º—É–º 25MB
- **–û–±—â–∏–π –ª–∏–º–∏—Ç:** 50MB –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤

## üîß **–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞:**
```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);

const response = await fetch('/api/v1/upload', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer ' + token
    },
    body: formData
});

const result = await response.json();
console.log('File uploaded:', result.file_url);
```

### **2. –û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```javascript
const message = {
    type: 'image',
    content: '–ü–æ—Å–º–æ—Ç—Ä–∏ –Ω–∞ —ç—Ç–æ —Ñ–æ—Ç–æ!',
    media_url: result.file_url
};

await fetch(`/api/v1/chats/${chatId}/messages`, {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer ' + token,
        'Content-Type': 'application/json'
    },
    body: JSON.stringify(message)
});
```

### **3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–¥–∏–∞ –≤ —á–∞—Ç–µ:**
```javascript
function displayMessage(message) {
    if (message.type === 'image') {
        return `<img src="${message.media_url}" alt="Image" style="max-width: 300px;">`;
    } else if (message.type === 'video') {
        return `<video controls style="max-width: 300px;"><source src="${message.media_url}"></video>`;
    } else if (message.type === 'voice') {
        return `<audio controls><source src="${message.media_url}"></audio>`;
    }
    return message.content;
}
```

## üöÄ **–í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

### **1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞:**
- **–°–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
- **–ü—Ä–µ–≤—å—é –≤–∏–¥–µ–æ** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏–Ω–∏–∞—Ç—é—Ä
- **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ EXIF, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤

### **2. CDN –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- **–û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** - AWS S3, Google Cloud Storage
- **CDN** - –±—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏

### **3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:**
- **–î–æ–∫—É–º–µ–Ω—Ç—ã** - PDF, DOC, TXT
- **–ê—Ä—Ö–∏–≤—ã** - ZIP, RAR
- **3D –º–æ–¥–µ–ª–∏** - OBJ, STL

### **4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—É—Å–æ–≤** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–í–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏** - –∑–∞—â–∏—Ç–∞ –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö –ø—Ä–∞–≤
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞—â–∏—Ç–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- **–†–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞** - –æ–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤
- **–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** - –∫–∞–∫–∏–µ —Ç–∏–ø—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç —á–∞—â–µ
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∑–æ–∫ –≤ –¥–µ–Ω—å
- **–û—à–∏–±–∫–∏** - –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏

## ‚úÖ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:**

**–°–∏—Å—Ç–µ–º–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞!**
- üéØ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤**
- üõ°Ô∏è **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞**
- üì± **–ì–æ—Ç–æ–≤–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π**
- üöÄ **–õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è**

**–ú–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ –∏ –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!** üì∏üé•üéµ
